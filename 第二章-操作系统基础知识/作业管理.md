# 一、作业管理

作业时系统完成一个用户的计算任务(或一次事务处理)所作的工作总和。例如，对用户编写的源程序，需要经过编译、链接、装入以及执行等步骤得到结果，其中的每一个步骤称为一个作业步。操作系统中用来控制作业进入、执行和撤销的一组程序称为作业管理程序。操作系统可以进一步为每个作业创建作业步进程，完成用户的工作

## 1.1 作业管理
### 1.1.1 作业控制

可以采用 **脱节和联机** 两种控制方式控制用户作业的运行。
* 脱机控制方式。作业允许过程 **无须人工干预** ，用户必须将工作内容用作业控制语言(JCL)编写成作业说明书，连同作业一起提交个计算机系统。
* 联机控制方式。操作系统向用户提供了一组联机命令，用户可以通过终端输入命令，将工作内容告诉个计算机，以控制作业的运行过程，此过程 **需要人工干预** 

作业由**程序、数据和作业说明书**三部分组成。 **作业说明书包括作业基本情况、作业控制、作业资源要求的描述，它体现用户的控制意图** 。
* 作业基本情况包括 **用户名、作业名、编程语言、最大处理时间** 等
* 作业控制包括 **作业控制方式、作业步的操作顺序、作业执行出错处理** 
* 作业资源要求的描述包括 **处理时间、优先级、主存空间、外设类型和数量、实用程序要求** 等。

### 1.1.2 作业的状态及其转换

作业状态分为4种：提交、后备、执行、完成，其状态及转换如下图

![](https://images.gitee.com/uploads/images/2021/0127/154957_47c31359_7841459.jpeg "u=1701406261,4277521148&fm=26&gp=0.jpg")


* 提交。作业提交给计算机中心， **通过输入设备送入计算机系统的过程称为提交状态** 

* 后备。通过Spooling系统将作业输入到计算机系统的后备存储器(磁盘)中，随时 **等待作业调度程序调度的状态** 

* 执行。一旦作业被调度程序选中，为其分配了必要的资源，并建立相应的进程后。该作业便进入了执行状态

* 完成。当作业正常结束或异常终止时，作业进入完成状态。此时，由作业调度程序对该作业进行善后处理。例如，撤销作业的作业控制块；收回作业所占用的系统资源；将作业的执行结果形成输出文件放到输出井，由Spooling系统控制输出

### 1.1.3 作业控制块和作业后备队列

作业控制块(JCB)是记录与该作业有关的各种信息的登记表。 **JCB是作业存在的唯一标志** ，主要包括用户名、作业名和状态标志信息等。

作业后备队列由若干个JCB组成。由于在输入井中有较多的后备作业，为了便于作业调度程序调度，通常将 **作业控制块排成一个或多个队列，而这些队列被称为作业后备队列。** 

## 1.2 作业调度

### 1.2.1 作业调度算法的选择

选择的调度算法应与系统的整个设计目标一致。例如，批处理系统应该注重提高计算机系统的效率，尽量增加系统的处理能力；分时系统应该保证用户接受的响应时间；实时系统首先必须保证及时响应和处理与时间有关的时间，其次才系统资源的利用率。

调度算法的选择应该考虑如下因素
1. 均衡使用系统资源。使“I/O繁忙”的作业和“CPU繁忙”的作业搭配起来执行
2. 平衡系统和用户的要求。确定算法时要尽量缓和系统和用户之间的矛盾
3. 缩短作业的平均周转时间。在多用户环境下，作业“立即执行”往往难以做到，但是应保证进入系统的作业在规定截止时间内完成，而系统应设法缩短作业的平均周转时间。

### 1.2.2 作业调度算法

1. 单道批处理。在单道批处理中，常采用下面3种算法

    *  **先来先服务** 。作业到达先后次序进行调度，启动等待时间最长的作业。
    *  **短作业优先** 。以要求运行时间长短进行调度，先启动运行时间最短的作业
    *  **响应比高者优先** 。响应比高的作业先启动。响应比$R_p=\frac{作业响应时间}{作业执行时间}$。其中$作业响应时间=作业等待时间+执行时间$，所以$R_p=1+\frac{作业等待时间}{作业执行时间}$
    
        响应比高者优先算法每次调度前都要计算所有备选作业的响应时间比，然后选择响应时间比高的作业执行，该算法比较复杂，系统开销大。

2. 多道批处理。在多道批处理系统中，通常采用 **优先级调度算法和均衡调度算法** 进行作业调度。
   
    * **优先调度算法** ：为了照顾时间要求紧迫的作业，或者“I/O繁忙”的作业，以充分发挥外设效率；或者在一个兼顾分时操作和批处理系统中，为了照顾终端会话型作业，以便获得合理的响应时间，需要采用基于优先级的调度策略，即高优先级优先，由用户指定优先级，优先级高的作业先启动。

    * **均衡调度算法** ：根据系统的运行情况和作业本身的特性对作业进行分类。作业调度程序轮流地从这些不同类别的作业中挑选作业执行。这种算法力求均衡地使用系统的各种资源，即注意发挥系统效率，又使用户满意。例如，将出现在输入井中的作业分成A、B、C三个队列
        * A队：短作业，其计算时间小于某个值，无特殊外设要求
        * B队：要用到磁盘的作业，它们要使用一条或多条私用磁带
        * C队：长作业，其计算时间超过一定值

### 1.2.3 作业调度算法性能衡量指标

在一个批处理为主的系统中，通常用平均周转时间或平均周转系数来均衡调度性能的优劣。假设作业$J_i(i=1,2,...,n)$的提交时间为$t_{si}$，执行时间为$t_{ri}$，作业完成时间为$t_oi$，则作业$J_i$的周转时间$T_i$和周转系数$W_i$的定义为
$$
T_i=t_{oi}-t_{si} \qquad (i=1,2,\cdots, n)\\
W_i=\frac{T_i}{t_{ri}} \qquad (i=1,2,\cdots, n)
$$
$n$个作业的平均周转时间$T$和平均周转系数$W$分别定义为
$$
T=\frac{1}{n}\sum_{i=1}^{n}T_i\\
W=\frac{1}{n}\sum_{i=1}^{n}W_i
$$

## 1.3 人机界面

用户界面(User Interface)是计算机中实现用户与计算机通信的软件、硬件部分的总称。用户界面也称用户接口或人机界面。

用户界面的硬件部分包括用户向计算机输入数据或命令的输入装置，以及由计算机输出供用户观察或处理的输出装置。用户界面的软件部分包括用户与计算机相互通信的协议、约定、操纵命令及其处理软件。计算机用户界面的发展过程为4个阶段: **控制面板式、字符用户、图形用户及新一代用户界面**

1. **控制面板式用户界面**。用户通过控制台开关、板键或穿孔纸带向计算机送入命令或数据，而计算机通过指示灯以及打印机输出运行情况或结果。特点是**要求人去适应计算机**

2. **字符用户界面**。基于字符型的。用户通过键盘或其他输入设备输入字符，由显示器或打印机输出字符。优点是**功能强大、灵活、屏幕开销少**；确定是**操作步骤烦琐，对非专业技术人员不友好**

3. **图像用户界面**。用户可以使用图形、图像、声音同计算机交互，操作更为自然和方便。形声兼备的多媒体技术进一步得到推广、发展与完善。现代界面的关键技术是**超文本**，不仅包含了文本，还包含了图像、音频和视频等多媒体信息。

4. **新一代用户界面**。虚拟现实技术将用户界面发展推向了一个新阶段，人将作为参与者，以自然的方式与计算机生成的虚拟环境进行通信。以**用户为中心、自然、高效、高带宽、非精确和无地点限制等新一代用户界面的特征**。计算机将通过多种感知通道来理解用户的意图，实现用户的要求。计算机仿真环境向用户提供真实的体验感。