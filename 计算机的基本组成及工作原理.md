# 一、计算机的基本组成及工作原理

计算机硬件的基本组成包括运算器、控制器、存储器、输入设备、输出设备五大部件组成。其中，运算器和控制器被集成到了一起称为CPU。

运算器(Arithmetic and Logic Unit, ALU)是对数据进行加工处理的部件，能够完成算术运算和逻辑运算，称为算术逻辑单元

控制器主要是从主存种取出指令并进行分析，以控制计算机各个部件有条不紊的完成指令的功能

存储器主要分为内存和外存，为了提高整个系统的运行速度，计算机种往往设有寄存器、高速缓存等存储器

输入/输出设备是计算机系统与外界交换信息的部件，一般通过总线和接口将主机与I/O设备组合在一起。

## 1.1 总线的基本概念
总线是连接多个设备的信息传送通道，也就是一组信号线；任何连接两个以上电子元器件的导线都可以称为总线。

### 1.1.1 总线的分类
1.  **芯片内总线** 。芯片内各个部件的连接
2.  **元件级总线** 。用于一块电路板内各元件的连接
3.  **系统总线** ，又称内总线。用于计算机各个组成部分的连接(连接CPU 内存等)
4.  **外总线** ，又称通信总线。用于计算机与外设或计算机与计算机之间的连接通信

#### 1.1.2 系统总线

**系统总线** (System Bus)是微机系统中重要的总线，对计算机的运行的性能由总要影响。CPU通过系统总线对存储器内容进行读写；同样通过系统总线，实现将CPU内数据写入外设，或由外设读入CPU。按照信息传递功能分为 **地址总线、数据总线、控制总线** 。

系统总线的性能主要有 **带宽、位宽和工作频率** 

* 带宽：指单位时间内总线上传送的数据量(每秒钟传送得最大稳态数据传输率)
* 位宽：指总线能同时传送的二进制数据，或数据总线的位数
* 工作频率：是指数据传输的频率，以 MHz 为单位

它们之间的关系：$总线的带宽=总线的工作频率\times \frac{总线的位宽}{8}$

常见的传统系统总线有ISA、EISA、PCI/AGP等。

1. ISA总线(工业标准总线)

    与PC总线兼容，在原有的PC总线的62个插座信号的基础上扩充了36个信号插座。
    * 24条地址线
    * 16条数据线
    * 控制总线
        * 内存读写
        * 接口读写
        * 中断请求
        * 中断响应
        * DMA请求和响应
    * $\pm5V、\pm12V$电源和地线

2. EISA总线
    
    它是在ISA总线上发展起来的32位总线，该总线定义了 **32位地址线** 、 **32位数据线** 以及其他控制信号线、电源线、地线等 **196个接点** 。总线传输 **速率可达$33Mb/s$** 。EISA总线利用总线插座与ISA总线兼容，插板插在上层为ISA总线信号；插板插在下层为EISA总线

3. PCI总线
    
    目前微机上广泛采用的内总线。有两种标准
    * 适用于32位机的124个信号的标准, 传输速率至少为$133Mb/s$
    * 适用于64位机的188个信号的标准, 传输速率至少为$266Mb/s$

    **与处理器的工作相互独立** ，也就是，PCI总线时钟与处理器时钟独立、非同步。 **PCI总线设备时即插即用。** 目前PCI总线遇到了并行总线的技术难题
    
4. AGP总线

    图像加速端口。Intel公司推出的图形显示卡专用局部总线
    * **直接与主板的北桥芯片相连** ，从而让显卡芯片与主存直接相连，避免了窄带宽的PCI总线形成系统瓶颈，增加3D图形数据传输速度， **显卡内存不足时还可以调用主存** 。
    * AGP标准工作在32位总线时由$66MHz$和$133MHz$两种工作频率，最高传输速率$266Mb/s$ 和 $533Mb/s$

5. PCI-E总线(PCI Express)

    采用 **点对点串行连接** ，每个 **设备都有自己的专用连接** ，不需要向整个总线请求带宽。PCI-E X1和PCI-X16是目前主流规格；PCI-E总线支持 **高阶电源管理，支持热插拔，数据同步传输，为优先传输数据进行带宽优化** 
     
### 1.1.3 外总线
外总线标准由很多，主流的由如下几种
1. RS-232C。串行外总线

    * 传输线少，最少3根(一条发送数据，一条接收数据，一条地线)及可实现全双工通信
    * 传输距离远
    * 具有较好的抗干扰性
2. RS-485。平衡发送、差分接受
    
    * 抑制共模干扰
    * 通信距离远
3. SCSI。小型计算机系统接口，是一种并行外总线
    
    * 广泛用于软硬磁盘、光盘和扫描仪
    * 早期是 8 位，后来扩展到了16位、32位
    * Ultra320 SCSI 单通道可达$320Mb/s$；双通道可达$640Mb/s$
4. USB。通用串行总线
    
    目前广泛应用，USB接口已经成为计算机硬件系统的基本配置。
    * USB 1.0有两种传输速率：低速，$1.5Mb/s$;高速，$12Mb/s$
    * USB 2.0传输速率为$480Mb/s$
    * USB支持 **即插即用** 并 **支持热插拔** 
5. IEEE-1394.串行数据传输协议

    支持 **即插即用** 并 **支持热插拔** 
    * 比USB相比速率更快、用于音频、视频等数据传输
    * IEEE-1394理论可以连接64台设备
    * 传输速率有$100Mb/s、400Mb/s、800Mb/s、1600Mb/s、3.2Gb/s$

## 1.2 中央处理单元
CPU是Central Process Unit，简称微处理器。是计算机工作的核心部件，用于控制并协调各个部件
### 1.2.1 CPU的功能
1. **指令控制** 。执行指令控制程序执行顺序( **重要职能** )
2. 操作控制。一条指令功能实现需要若干操作信号完成，CPU产生每条指令的操作信号并传送到不同的部件，控制部件按指令功能完成操作
3. 时序控制。CPU通过时序电路产生时钟信号进行定时，控制各种操作按指定的时序进行
4. **数据处理** 。在CPU的控制下完成对数据加工处理( **最根本的任务** )

### 1.2.2  CPU的组成
CPU主要由运算器、控制器、寄存器组和内部总线组成。

![](https://images.gitee.com/uploads/images/2021/0109/194750_27062ac6_7841459.png "屏幕截图.png")

1. 运算器

    运算器(简称ALU)主要完成 **算术运算和逻辑运算** , 实现对数据的加工处理。计算机的运算器结构不同，基本都包括 **算术运算和逻辑运算单元** 、 **累加器(AC)** 、 **状态字寄存器(PSW)** 、 **寄存器组** 及多路转换器等。
    * 寄存器组的作用是 **暂存操作数或数据地址** 
    * 标志寄存器也称状态字寄存器，用于 **存放算术、逻辑运算过程中产生的状态信息** 
    * 累加器，用于 **暂存运算结果或向ALU提供运算对象** 
2. 控制器
    
    主要功能是 **从内存中取出指令，并指出下一条指令在内存中的位置** ，将取出的指令送入到 **指令寄存器** ，启动 **指令译码器** 对指令进行分析，最后发出响应的控制信号和定时信息，控制和协调计算机各个部件的工作，完成指令规定的操作。
    
    控制器由 **程序计数器(PC)** 、 **指令寄存器(IR)** 、 **指令译码器** 、 **状态字寄存器(PSW)** 、 **时序产生器** 和 **微操作信号发生器** 组成
![](https://images.gitee.com/uploads/images/2021/0109/195848_dfdd041c_7841459.png "屏幕截图.png")
* 程序计数器(PC): 当程序顺序执行时，每取出一条指令，PC内容自动增加指向下一条要待取指令。当程序出现转移时，则将转移地址送人PC，然后由PC指出新的指令地址

* 指令寄存器：存放正在执行的指令

* 指令译码器：对现行 **指令分析** ，确定指令类型和指令要完成的操作及寻址方式

* 时序部件：用于 **产生时序脉冲和节拍电位** 以控制计算机各部件有序工作

* 状态字寄存器(PSW): 用于 **保存指令执行完成后产生的条件码** ，例如运算结果是否溢出，结果为正还是为负，是否由进位等。PSW还 **保存中断和系统工作状态**

* 微操作信号发生器：根据指令提供的操作信号、时序产生器提供的时序信号，以及各功能部件反馈的状态信信号等综合特定的操作序列，从而完成 **对指令的执行控制** 

控制器的作用控制整个计算机各个部件工作， **基本功能是从内存中取指令和执行指令** 

 **执行指令的步骤** 
* 取指令。先从程序计数器所指出的指令地址从内存中取出一条指令
* 指令译码。将指令的操作码部分送入指令译码器进行分析，然后根据指令的功能向有关部件发送控制命令
* 按指令操作码执行。根据指令译码器产生的操作控制命令以及程序状态字寄存器的状态， **控制微操作形成部件产生一系列CPU内部控制信号和输出到CPU外部的控制信号** 。在控制信号的控制下，实现指令的具体功能。
* 形成下一条指令地址。若非转移类指令，则修改程序计数器的内容；若为转义类型指令，则根据转移条件修改程序计数器的内容


3. 寄存器组

    寄存器是CPU内部的临时存储单元。可以用来存放数据和地址，也可以存放控制信号或CPU工作是的状态。**增加CPU寄存器数量可以减少CPU访问内存的次数，提高运行速率**。但是，寄存器增加也会导致寄存器地址编码增加从而增加指令长度。
    
    CPU 中的寄存器分为数据寄存器、地址寄存器、控制信号寄存器、状态信息寄存器和其他类型寄存器
    *  **累加器(Accumulator)** ：累加器是数据寄存器， **暂存操作数和中间运算结果** ，不能用于长时间保存数据

    *  **通用寄存器组** ： **暂存操作数或地址** ，使用它可以减少CPU访问内存的次数，提高运行速率

    * **标志寄存器(状态寄存器)** ：记录运算中产生的标志信息。每一位单独使用，称为标志位。反映了ALU的工作状态
        *  **进位标志位(C)** : 最高位产生进位时，该位置为 1
        *  **零标志位(Z)** : 运算结果为零时置为 1
        *  **符号标志位(S)** : 运算结果为负时置为 1
        *  **溢出标志位(V)** : 运算结果溢出时置为 1
        * ** 奇偶标志位(P)** : 运算结果中 1 的个数为偶数时置为 1

    *  **指令寄存器** ： **存放正在执行的指令** ，指令从内存中取出送入指令寄存器。指令的操作码被指令译码器送入微操作信号发生器，地址码指明参与运算的操作数的地址形成方式。 **指令执行过程中，指令寄存器中的内容不变** 

    * **数据缓冲寄存器(MDR)** 暂时存放由内存读出的一条指令或一个数据字；反之，向内存存入一个数据字，也暂时存放在数据缓冲寄存器中。

    *  **地址寄存器(MRA)** : 保存当前CPU访问的内存单元的地址。由于内存和CPU之间存在操作速度的差别，所以使用地址寄存器来保持地址信息，直到内存读写操作完成
    
    * 其他寄存器：根据CPU的结构特点还存在如堆栈指示器、变址寄存器和段地址寄存器

4. CPU内部总线：CPU内部总线将运算器、控制器、寄存器等连接在一起。
 
### 1.2.3 双核和多核处理器
半导体工工艺的每一次进步都为微处理器开辟了新的领域；体系结构的进展又在半导体工艺技术发展的基础上进一步提高了微处理器的性能。

CPU中最核心的组成部分称为内核或核心(Die), CPU的所有计算、接受/存储指令、数据处理都由核心执行。

双核处理器是在一个处理器上集成两个运算核心，从而提高计算能力。处理器的性能是处理器在每个时钟周期能够处理的指令总数，增加一个内核，处理器每个时钟周期可以执行的指令数翻倍。

多核芯片，在一个处理器中集成两个或多个内核，采用分治策略，通过划分任务，线程应用能够充分利用多个执行内核，并在特定时间内执行更多的任务。

## 1.3 存储系统
### 1.3.1 存储器分类
1. 按存储器所在位置分为**内存和外存**
2. 按构成存储器的材料分为**磁介质存储器、半导体存储器**

## 1.4 输入输出技术


