# 一、进程管理

也称为处理机管理，目的式合理分配处理机得时间，提高系统的效率。在计算机系中有多个并发执行的程序，采用"程序"不能描述程序执行时的动态变化的过程，因此引入了"进程"
## 1.1 基本概念
1.  **程序执行时的特征** 

    ![](https://images.gitee.com/uploads/images/2021/0119/175225_bea53a9f_7841459.png "屏幕截图.png")

    前驱图是一个有向无循环图，节点代表程序段的操作，连接节点的边表示节点之间的前驱关系。

    程序顺序执行时主要特征有**顺序性、封闭性、可再现性**
    * 顺序性。程序段严格按照规定的顺序执行
    * 封闭性。程序运行时系统内的资源只受该程序控制而改变，执行结果不受外界因数改变
    * 可再现性。在相同的环境和初始条件下，程序执行多次的结果相同。

    ![](https://images.gitee.com/uploads/images/2021/0119/192013_1ba467ee_7841459.png "屏幕截图.png")
    
    计算机系统采用多道程序设计技术，则主存中的多道程序并发执行。如上图的三个程序，同一个作业内没有前驱关系的程序段或不同的作业程序段可以分别在CPU和各输入输出设备上并发执行。

    程序并执行时的特征
    * 失去程序的封闭性
    * 程序和机器执行程序的活动不在一一对应
    * 并发程序间具有相互制约

2. **进程的组成**
    
    进程(Process)时程序的一次执行。进程通常由**程序、数据和进程控制块(Process Contorl Block)**组成。其中PCB是进程存在的唯一标识，主要内容如下表
    ![](https://images.gitee.com/uploads/images/2021/0119/192646_f20deb89_7841459.png "屏幕截图.png")
    
    进程的程序部分描述了进程需要完成的功能。如果程序可以被多个进程同时共享执行，则这部分就应该以可再入码的形式编制，是程序中不可修改的部分。

    进程的数据部分包括程序执行时需要的数据及工作区， **只能被一个程序所专用** ，是进程可以修改的部分。

3. 进程的状态及其状态间的切换

    在多道程序系统中，进程的运行是走走停停，在处理器上交替运行，状态也不断的发送变化。进程一般有3种基本状态： **运行、就绪、阻塞**，如下图；

    ![](https://images.gitee.com/uploads/images/2021/0119/193205_258e631b_7841459.png "屏幕截图.png")
    *  **运行态** ： **进程在处理机上执行时** ，称该进程处于运行状态。显然，单处理机系统，处于运行状态的进程只有一个。
    *  **就绪态** ： **进程获得了处理机外的一切所需资源**，一旦获得处理机即可运行，则称为进程的就绪态。
    *  **阻塞态** ：**进程正在等待某一事件发生**(例如，I/O事件)而暂时停止运行，这时即使把处理机分配给该进程也无法运行，故称该状态为阻塞态。
    
    进程状态还可以分为五种: **新建、就绪、运行、阻塞、终止**
    ![](https://images.gitee.com/uploads/images/2021/0119/195415_f3a2c992_7841459.png "屏幕截图.png")
    * **新建态** : 进程刚被创建还没有被提交的状态，并等待系统完成创建的所有必要信息。新建进程需要经过两个阶段: 第一阶段，为一个新进程创建必要的管理信息；第二阶段，让进程进入就绪态。新建态可以使操作系统根据系统的性能和内存容量限制推迟新建态进程的提交。
    * **终止态** ： **进程停止运行的状态** ，分为两个阶段：第一阶段，等待操作系统进行善后处理；第二阶段，释放内存。终止态的目的是防止系统进行善后处理时引起资源分配不当等问题。

## 1.2 进程控制

进程控制是指对系统中所有进程从创建到消亡的全过程实施有效控制。操作系统中通过设置一套控制机构对进程实施控制，主要功能包括**创建一个新进程、撤销一个已经运行完成的进程、改变进程状态、实现进程间通信**。由操作系统内核中的原语实现。

原语(Primitive)是指若干条机器指令组成的、用于完成特定功能的程序段。特点: **在执行时不能分割(原子操作)**，内核原语主要包括**进程控制原语、进程撤销原语、进程挂起原语、进程激活原语、进程阻塞原语、进程唤醒原语等**。大多数系统内核都包含**支撑功能和资源管理功能**

## 1.3 进程通信

在多道程序环境的系统中，存在多个可并发执行的进程，因此进程间必然存在资源共享的相互合作的问题。 **进程通信指各个进程交换信息的过程** 。

1. 同步与互斥
    
    多个并发执行的进程都以各自独立的、不可预知的速度向前推进，但是有时需要在某些确定点上协调相互合作进程间的工作。

     **进程间同步是指进程间完成一项任务时直接发生相互作用的关系** 。例如，进程A和进程B，当进程B从缓冲区取出数据时，进程A已经完成了向缓冲区写入数据的操作，如果缓冲区中没有数据，则进程B将等待进程A向缓冲区写入数据。

   在多道程序系统中，各进程可以共享资源，但是有些资源只能被一个进程占用。只能被一个进程占用的资源称为临界资源(Critical Resource)。 **进程间互斥是指系统中进程互斥使用临界资源。** 

    临界区(Critical Section)是进程中对临界资源实施财政的程序段。互斥临界区管理的4个原则
    1. **有空即进** ：无程序处于临界区时，允许进程进入临界区，并且只能在临界区允许有限的时间
    2. **无空则等** ：当有一个进程在临界区时，其他需要进入临界区的进程必须等待，以保证进程互斥地访问临界资源
    3. **有限等待** ：对要访问临界资源地进程，应保证进程等待有限时间后进入临界区，以免陷入"饥饿"状态
    4. **让权等待** ：当进程不能进入自己的临界区时，应立即释放处理机，以免进程陷入"忙等"状态

2. 信号量机制












